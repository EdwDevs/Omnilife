<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1e40af">
    <meta name="description" content="Calculadora de precios Omnilife con descuento del 35%. Consulta productos y calcula ganancias.">
    <title>üí∞ Calculadora Omnilife - Precios con 35% de Descuento</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* ========================================
           üé® VARIABLES DE DISE√ëO MEJORADAS
           ======================================== */
        :root {
            /* Colores principales */
            --primary: #1e40af;
            --primary-light: #3b82f6;
            --primary-dark: #1e3a8a;
            --accent: #10b981;
            --accent-light: #34d399;
            --success: #059669;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
            
            /* Tonos de gris */
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            
            /* Sombras mejoradas */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            
            /* Radiuses */
            --radius-sm: 0.375rem;
            --radius: 0.5rem;
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            --radius-xl: 1.5rem;
            --radius-full: 9999px;
            
            /* Transiciones */
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s ease;
        }

        /* ========================================
           üîß RESETEO Y BASE
           ======================================== */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: var(--gray-800);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            min-height: 100vh;
            padding: 1rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* ========================================
           üéØ HEADER MODERNO
           ======================================== */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-xl);
            animation: slideDown 0.5s ease-out;
        }

        .header-inner {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: center;
            text-align: center;
        }

        .app-title {
            font-size: 2rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            justify-content: center;
        }

        .app-title i {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 1.75rem;
        }

        .app-subtitle {
            color: var(--gray-600);
            font-size: 1rem;
            font-weight: 500;
        }

        .app-subtitle strong {
            color: var(--accent);
            font-weight: 700;
        }

        .header-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--gray-500);
            font-size: 0.875rem;
        }

        /* ========================================
           üìä RESUMEN ESTAD√çSTICAS
           ======================================== */
        .summary {
            margin-bottom: 2rem;
        }

        .summary-inner {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }

        .summary-item {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow-md);
            transition: var(--transition);
            animation: fadeInUp 0.5s ease-out;
        }

        .summary-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        .summary-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--gray-500);
            letter-spacing: 0.05em;
        }

        .summary-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin-top: 0.5rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ========================================
           üîç BUSCADOR MEJORADO
           ======================================== */
        .search-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 0.6s ease-out;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title i {
            color: var(--primary);
        }

        .search-input-group {
            position: relative;
        }

        #searchInput {
            width: 100%;
            padding: 1rem 3.5rem 1rem 1.25rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            font-weight: 500;
            transition: var(--transition);
            background: white;
        }

        #searchInput:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }

        .btn-icon {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            color: var(--gray-400);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--radius);
            transition: var(--transition-fast);
            font-size: 1.125rem;
        }

        .btn-icon:hover {
            color: var(--primary);
            background: var(--gray-100);
        }

        .clear-btn {
            right: 3rem;
        }

        .search-btn {
            right: 0.5rem;
        }

        .search-results {
            max-height: 300px;
            overflow-y: auto;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            background: white;
            margin-top: 1rem;
            box-shadow: var(--shadow-md);
            animation: fadeIn 0.3s ease;
        }

        .search-result-item {
            padding: 1rem;
            border-bottom: 1px solid var(--gray-100);
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-item:hover,
        .search-result-item.focus {
            background: var(--gray-50);
        }

        .result-code {
            font-weight: 700;
            color: var(--primary);
            font-size: 0.875rem;
        }

        .result-desc {
            margin: 0.25rem 0;
            color: var(--gray-700);
            font-weight: 500;
        }

        .result-price {
            font-size: 0.875rem;
            color: var(--accent);
            font-weight: 600;
        }

        /* ========================================
           üßÆ CALCULADORA
           ======================================== */
        .calculator-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 0.7s ease-out;
        }

        .calculator-grid {
            display: grid;
            gap: 1.5rem;
            grid-template-columns: 1fr;
        }

        .calc-input label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--gray-700);
            font-size: 0.875rem;
        }

        .calc-input select,
        .calc-input input {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-lg);
            font-size: 1rem;
            font-weight: 500;
            transition: var(--transition);
            background: white;
        }

        .calc-input select:focus,
        .calc-input input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
        }

        .calc-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
            flex: 1;
            min-width: 140px;
        }

        .btn.primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn.primary:active {
            transform: translateY(0);
        }

        .btn.secondary {
            background: white;
            color: var(--gray-700);
            border: 2px solid var(--gray-300);
        }

        .btn.secondary:hover {
            background: var(--gray-50);
            border-color: var(--gray-400);
        }

        /* ========================================
           üìà RESULTADOS
           ======================================== */
        .results-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(249, 250, 251, 0.95));
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: var(--shadow-xl);
            animation: fadeInScale 0.4s ease-out;
        }

        .results-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .results-grid {
            display: grid;
            gap: 1.5rem;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        }

        .result-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            text-align: center;
            transition: var(--transition);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }

        .result-card.cost-card::before {
            background: linear-gradient(90deg, #3b82f6, #06b6d4);
        }

        .result-card.price-card::before {
            background: linear-gradient(90deg, #10b981, #34d399);
        }

        .result-card.profit-card::before {
            background: linear-gradient(90deg, #f59e0b, #fbbf24);
        }

        .result-card.margin-card::before {
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
        }

        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
            border-color: var(--gray-200);
        }

        .result-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .result-header i {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .result-header h4 {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .result-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
            line-height: 1.2;
        }

        .result-subtitle {
            font-size: 0.75rem;
            color: var(--gray-500);
            font-weight: 500;
        }

        /* ========================================
           üìã TABLA DE PRODUCTOS
           ======================================== */
        .products-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: var(--radius-xl);
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 0.8s ease-out;
        }

        .table-wrapper {
            overflow-x: auto;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow);
        }

        .products-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        .products-table th,
        .products-table td {
            padding: 1rem;
            text-align: left;
            font-size: 0.875rem;
        }

        .products-table th {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.75rem;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .products-table tbody tr {
            border-bottom: 1px solid var(--gray-100);
            transition: var(--transition-fast);
        }

        .products-table tbody tr:hover {
            background: var(--gray-50);
        }

        .select-btn {
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            color: white;
            border: none;
            border-radius: var(--radius);
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .select-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* ========================================
           üéØ UTILIDADES
           ======================================== */
        .hidden {
            display: none !important;
        }

        .text-success {
            color: var(--success) !important;
        }

        .text-warning {
            color: var(--warning) !important;
        }

        .text-danger {
            color: var(--danger) !important;
        }

        .text-muted {
            color: var(--gray-500) !important;
        }

        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* ========================================
           üé¨ ANIMACIONES
           ======================================== */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ========================================
           üì± RESPONSIVE
           ======================================== */
        @media (min-width: 640px) {
            .calculator-grid {
                grid-template-columns: 2fr 1fr;
            }
        }

        @media (min-width: 768px) {
            .header-inner {
                flex-direction: row;
                justify-content: space-between;
                text-align: left;
                align-items: center;
            }

            .app-title {
                justify-content: flex-start;
            }

            .calculator-grid {
                grid-template-columns: 2fr 1fr auto;
            }
        }

        @media (min-width: 1024px) {
            body {
                padding: 2rem;
            }
        }

        /* ========================================
           üé® SCROLLBAR PERSONALIZADO
           ======================================== */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: var(--radius-full);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gray-400);
            border-radius: var(--radius-full);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-500);
        }

        /* ========================================
           üéØ FOOTER
           ======================================== */
        .footer {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: var(--radius-xl);
            padding: 2rem;
            text-align: center;
            color: var(--gray-600);
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 0.9s ease-out;
        }

        .footer-inner p {
            margin-bottom: 0.5rem;
        }

        .attribution {
            font-size: 0.875rem;
            color: var(--gray-500);
        }
    </style>
</head>
<body>
    <!-- üéØ HEADER -->
    <header class="header" role="banner">
        <div class="container header-inner">
            <div class="brand">
                <h1 class="app-title">
                    <i class="fas fa-calculator"></i>
                    <span>Calculadora Omnilife</span>
                </h1>
                <p class="app-subtitle">Precios con descuento del <strong>35%</strong> y precios sugeridos</p>
            </div>
            <div class="header-meta">
                <i class="fas fa-clock"></i>
                <span id="headerTime">--:--</span>
            </div>
        </div>
    </header>

    <main class="main-content" role="main">
        <div class="container">
            <!-- üìä RESUMEN -->
            <section class="summary" role="region" aria-label="Resumen r√°pido">
                <div class="summary-inner">
                    <div class="summary-item">
                        <div class="summary-label">Productos</div>
                        <div id="summaryCount" class="summary-value">‚Äî</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Resultados</div>
                        <div id="summaryResults" class="summary-value">‚Äî</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Tu Descuento</div>
                        <div class="summary-value">35%</div>
                    </div>
                </div>
            </section>

            <!-- üîç BUSCADOR -->
            <section class="search-section">
                <div class="search-container">
                    <h2 class="section-title">
                        <i class="fas fa-search"></i>
                        Buscar Producto
                    </h2>
                    <div class="search-input-group" role="search">
                        <label for="searchInput" class="visually-hidden">Buscar producto</label>
                        <input
                            type="search"
                            id="searchInput"
                            placeholder="Buscar por c√≥digo o descripci√≥n..."
                            autocomplete="off"
                            aria-controls="searchResults"
                            aria-expanded="false"
                        />
                        <button id="clearSearch" class="btn-icon clear-btn" type="button" aria-label="Limpiar b√∫squeda">
                            <i class="fas fa-times"></i>
                        </button>
                        <button id="searchBtn" class="btn-icon search-btn" type="button" aria-label="Buscar">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div id="searchResults" class="search-results" role="listbox" style="display: none;"></div>
                </div>
            </section>

            <!-- üßÆ CALCULADORA -->
            <section class="calculator-section">
                <div class="calculator-container">
                    <h2 class="section-title">
                        <i class="fas fa-chart-line"></i>
                        Calculadora de Precios
                    </h2>
                    <form id="calculatorForm" class="calculator-grid" autocomplete="off">
                        <div class="calc-input">
                            <label for="productSelect">Producto Seleccionado</label>
                            <select id="productSelect" name="productSelect">
                                <option value="">‚Äî Selecciona un producto ‚Äî</option>
                            </select>
                        </div>
                        <div class="calc-input">
                            <label for="quantityInput">Cantidad</label>
                            <input
                                type="number"
                                id="quantityInput"
                                name="quantityInput"
                                min="1"
                                value="1"
                                placeholder="1"
                            />
                        </div>
                        <div class="calc-actions">
                            <button id="calculateBtn" class="btn primary" type="button">
                                <i class="fas fa-calculator"></i>
                                Calcular
                            </button>
                            <button id="resetBtn" class="btn secondary" type="button">
                                <i class="fas fa-undo"></i>
                                Reiniciar
                            </button>
                        </div>
                    </form>

                    <!-- üìà RESULTADOS -->
                    <div id="results" class="results-container" style="display: none;">
                        <h3 class="results-title">
                            <i class="fas fa-chart-pie"></i>
                            Resultados del C√°lculo
                        </h3>
                        <div class="results-grid">
                            <article class="result-card cost-card">
                                <div class="result-header">
                                    <i class="fas fa-tags"></i>
                                    <h4>Tu Costo</h4>
                                </div>
                                <div class="result-value" id="costResult">$0</div>
                                <div class="result-subtitle">Con 35% de descuento</div>
                            </article>
                            <article class="result-card price-card">
                                <div class="result-header">
                                    <i class="fas fa-dollar-sign"></i>
                                    <h4>Precio Sugerido</h4>
                                </div>
                                <div class="result-value" id="priceResult">$0</div>
                                <div class="result-subtitle">Precio al p√∫blico</div>
                            </article>
                            <article class="result-card profit-card">
                                <div class="result-header">
                                    <i class="fas fa-arrow-up"></i>
                                    <h4>Ganancia</h4>
                                </div>
                                <div class="result-value" id="profitResult">$0</div>
                                <div class="result-subtitle">Tu beneficio</div>
                            </article>
                            <article class="result-card margin-card">
                                <div class="result-header">
                                    <i class="fas fa-percentage"></i>
                                    <h4>Margen</h4>
                                </div>
                                <div class="result-value" id="marginResult">0%</div>
                                <div class="result-subtitle">Porcentaje de ganancia</div>
                            </article>
                        </div>
                    </div>
                </div>
            </section>

            <!-- üìã TABLA DE PRODUCTOS -->
            <section class="products-section">
                <div class="products-container">
                    <h2 class="section-title">
                        <i class="fas fa-table"></i>
                        Cat√°logo de Productos
                    </h2>
                    <div class="table-wrapper">
                        <table class="products-table">
                            <thead>
                                <tr>
                                    <th>C√≥digo</th>
                                    <th>Descripci√≥n</th>
                                    <th>Puntos</th>
                                    <th>Precio Lista</th>
                                    <th>Tu Costo (35%)</th>
                                    <th>Precio Sugerido</th>
                                    <th>Acci√≥n</th>
                                </tr>
                            </thead>
                            <tbody id="productsTableBody">
                                <!-- Productos cargados din√°micamente -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- üéØ FOOTER -->
    <footer class="footer" role="contentinfo">
        <div class="container footer-inner">
            <p>&copy; 2025 Calculadora de Precios Omnilife</p>
            <small class="attribution">Dise√±ado para tu negocio üíº</small>
        </div>
    </footer>

    <!-- üöÄ JAVASCRIPT -->
    <script>
        // ========================================
        // üì¶ BASE DE DATOS DE PRODUCTOS
        // ========================================
        const products = [
            { code: "4250604", description: "ALOE BETA PI√ëA, 200 ML E", points: 5, listPrice: 9700, discount35: 8773, suggestedPrice: 12800 },
            { code: "4850500", description: "EGO FRUTAS DEL BOSQUE EVOLUCI√ìN LATA 355 ML", points: 26, listPrice: 72200, discount35: 65298, suggestedPrice: 95350 },
            { code: "1260600", description: "EGO PLANT BOTELLA 200 ML E", points: 5, listPrice: 9700, discount35: 8773, suggestedPrice: 12800 },
            { code: "2075722", description: "BIOCROS SUPREME CAJA 30 SOBRES 240G", points: 53, listPrice: 90900, discount35: 82210, suggestedPrice: 120050 },
            { code: "1429653", description: "OMNILIFE F PLUS", points: 54, listPrice: 102000, discount35: 92249, suggestedPrice: 134750 },
            { code: "5174732", description: "CAFELIFE PLUS CAJA 30 SOBRES 150 G", points: 51, listPrice: 85000, discount35: 76874, suggestedPrice: 112300 },
            { code: "4160100", description: "AGUA BLU, SUPREME DE 1.5 LTS", points: 3, listPrice: 5750, discount35: 4370, suggestedPrice: 6400 },
            { code: "4160400", description: "AGUA BLU, SUPREME 600 ML", points: 1, listPrice: 2950, discount35: 2242, suggestedPrice: 3250 },
            { code: "4250204", description: "ALOE BETA PI√ëA 960 ML E", points: 25, listPrice: 47100, discount35: 42597, suggestedPrice: 62200 },
            { code: "3924734", description: "AQTUA SUPREME, CAJA 30 SACHETS", points: 112, listPrice: 146600, discount35: 132585, suggestedPrice: 193650 },
            { code: "4650609", description: "EGO 10 BOTELLA 200 ML E", points: 5, listPrice: 9700, discount35: 8773, suggestedPrice: 12800 },
            { code: "4978904", description: "EGO LIFE SUPREME CAJA 30 SOBRES", points: 32, listPrice: 63000, discount35: 56977, suggestedPrice: 83200 },
            { code: "1675700", description: "ESTOP PLUS CAJA 30 SACHETS 450G", points: 102, listPrice: 190400, discount35: 172198, suggestedPrice: 251500 },
            { code: "8453000", description: "FLU-Y BOTE 60 CAPSULAS", points: 39, listPrice: 76500, discount35: 69187, suggestedPrice: 101050 },
            { code: "5350513", description: "FX MANZANA EVOLUCI√ìN", points: 11, listPrice: 26000, discount35: 23514, suggestedPrice: 34350 },
            { code: "5350501", description: "FX NARANJA EVOLUCI√ìN", points: 11, listPrice: 26000, discount35: 23514, suggestedPrice: 34350 },
            { code: "1729752", description: "HOMO PLUS, CAJA 30 SACHETS 180 G", points: 54, listPrice: 102000, discount35: 92249, suggestedPrice: 134750 },
            { code: "1850610", description: "OMNILIFE KOLINA, BOTELLA 200 ML E", points: 5, listPrice: 9700, discount35: 8773, suggestedPrice: 12800 },
            { code: "6521959", description: "OMNIOST EVOLUCION 300GR", points: 57, listPrice: 111400, discount35: 100750, suggestedPrice: 147150 },
            { code: "2350430", description: "OMNIPLUS FRUTAS EVOLUCION 30 SACH 6", points: 79, listPrice: 139700, discount35: 126345, suggestedPrice: 184550 },
            { code: "2360401", description: "OMNIPLUS NARAN SUP CAJA 30 SOBRES 6", points: 78, listPrice: 139700, discount35: 126345, suggestedPrice: 184550 },
            { code: "5827415", description: "OMNIVIU SUPREME CAJA C/30 SACHETS 1", points: 58, listPrice: 95600, discount35: 86461, suggestedPrice: 126300 },
            { code: "2505711", description: "COGNOS EVOLUCION CAJA", points: 61, listPrice: 95200, discount35: 86099, suggestedPrice: 125750 },
            { code: "6722800", description: "OMNILIFE PROBIOTIC CAJA 30 SOBRES S", points: 62, listPrice: 118400, discount35: 107081, suggestedPrice: 156400 },
            { code: "5479243", description: "OMNILIFE PUMP SUPREME CAJA 12 SOBRE", points: 69, listPrice: 114800, discount35: 103825, suggestedPrice: 151650 },
            { code: "7170943", description: "OMNILIFE SHAKE SUPREME CAJA 12 SOBR", points: 76, listPrice: 121700, discount35: 110065, suggestedPrice: 160750 },
            { code: "7170921", description: "OMNILIFE SHAKE SUPREME FRESA SILVES", points: 76, listPrice: 121700, discount35: 110065, suggestedPrice: 160750 },
            { code: "3000730", description: "STARBIEN EVOLUCI√ìN CAJA C 30 SOBRES 240 GR S", points: 53, listPrice: 89900, discount35: 81306, suggestedPrice: 118750 },
            { code: "3178516", description: "SUPER MIX SUPREME VAINILLA CAJA 510", points: 76, listPrice: 118900, discount35: 107533, suggestedPrice: 157050 },
            { code: "3575609", description: "THERMOGEN TEA MARAC SUPREME 30 SACH", points: 92, listPrice: 154400, discount35: 139639, suggestedPrice: 203950 },
            { code: "3806816", description: "UZO EVOLUCION 240 GR", points: 167, listPrice: 244000, discount35: 220674, suggestedPrice: 322300 },
            { code: "5025516", description: "OMNILIFE VKIDS DOYPACK 400G", points: 71, listPrice: 121200, discount35: 109613, suggestedPrice: 160100 },
            { code: "3575605", description: "THERMOGEN TEA LIM√ìN, SUPREME C/30 SACHET", points: 54, listPrice: 102400, discount35: 92611, suggestedPrice: 135250 },
            { code: "6379929", description: "ONE C MIX PLUS CAJA", points: 43, listPrice: 78500, discount35: 70995, suggestedPrice: 103700 },
            { code: "4475910", description: "DOLCE VITA SUPREME TORONJA, CAJA 30 SACHETS", points: 63, listPrice: 115400, discount35: 104368, suggestedPrice: 152450 },
            { code: "1578400", description: "FIBER'N PLUS SUPREME SACHET 450 G", points: 66, listPrice: 120800, discount35: 109252, suggestedPrice: 159550 },
            { code: "2603201", description: "POWER MAKER, EVOLUCION", points: 110, listPrice: 156600, discount35: 141629, suggestedPrice: 206850 },
            { code: "2904727", description: "TMGN COFFEE DE OLLA EVOLUCION", points: 39, listPrice: 68510, discount35: 61960, suggestedPrice: 90500 },
            { code: "3304732", description: "TMGN COFFEE EVOLUCION", points: 39, listPrice: 68510, discount35: 61960, suggestedPrice: 90500 }
        ];

        // ========================================
        // üéØ VARIABLES GLOBALES
        // ========================================
        let selectedProduct = null;
        let searchFocusIndex = -1;

        // Elementos del DOM
        const searchInput = document.getElementById('searchInput');
        const clearSearchBtn = document.getElementById('clearSearch');
        const searchResults = document.getElementById('searchResults');
        const productSelect = document.getElementById('productSelect');
        const quantityInput = document.getElementById('quantityInput');
        const calculateBtn = document.getElementById('calculateBtn');
        const resetBtn = document.getElementById('resetBtn');
        const resultsDiv = document.getElementById('results');
        const productsTableBody = document.getElementById('productsTableBody');
        const summaryCountEl = document.getElementById('summaryCount');
        const summaryResultsEl = document.getElementById('summaryResults');
        const headerTimeEl = document.getElementById('headerTime');

        // ========================================
        // üõ†Ô∏è UTILIDADES
        // ========================================
        function formatCurrency(amount) {
            return new Intl.NumberFormat('es-CO', {
                style: 'currency',
                currency: 'COP',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function formatPercentage(percentage) {
            if (!isFinite(percentage)) return '‚Äî';
            return `${percentage.toFixed(1)}%`;
        }

        function debounce(fn, wait = 300) {
            let timeout;
            return (...args) => {
                clearTimeout(timeout);
                timeout = setTimeout(() => fn(...args), wait);
            };
        }

        // ========================================
        // üöÄ INICIALIZACI√ìN
        // ========================================
        function initApp() {
            populateProductSelect();
            populateProductsTable();
            setupEventListeners();
            updateSummaryCounts();
            updateHeaderTime();
            setInterval(updateHeaderTime, 60000);
            console.log('üöÄ Aplicaci√≥n inicializada correctamente');
            console.log(`üìä ${products.length} productos cargados`);
        }

        // ========================================
        // üìä POBLAR SELECT DE PRODUCTOS
        // ========================================
        function populateProductSelect() {
            productSelect.innerHTML = '<option value="">‚Äî Selecciona un producto ‚Äî</option>';
            products.forEach((p, i) => {
                const opt = document.createElement('option');
                opt.value = i;
                opt.textContent = `${p.code} - ${p.description}`;
                productSelect.appendChild(opt);
            });
        }

        // ========================================
        // üìã POBLAR TABLA DE PRODUCTOS
        // ========================================
        function populateProductsTable() {
            productsTableBody.innerHTML = '';
            products.forEach((product, index) => {
                const tr = document.createElement('tr');

                // C√≥digo
                const tdCode = document.createElement('td');
                const strong = document.createElement('strong');
                strong.textContent = product.code;
                tdCode.appendChild(strong);

                // Descripci√≥n
                const tdDesc = document.createElement('td');
                tdDesc.textContent = product.description;

                // Puntos
                const tdPoints = document.createElement('td');
                tdPoints.textContent = product.points;

                // Precio Lista
                const tdList = document.createElement('td');
                tdList.textContent = formatCurrency(product.listPrice);

                // Tu Costo
                const tdDiscount = document.createElement('td');
                tdDiscount.className = 'text-success';
                const sDiscount = document.createElement('strong');
                sDiscount.textContent = formatCurrency(product.discount35);
                tdDiscount.appendChild(sDiscount);

                // Precio Sugerido
                const tdSuggested = document.createElement('td');
                tdSuggested.className = 'text-warning';
                const sSuggested = document.createElement('strong');
                sSuggested.textContent = formatCurrency(product.suggestedPrice);
                tdSuggested.appendChild(sSuggested);

                // Bot√≥n Seleccionar
                const tdAction = document.createElement('td');
                const btn = document.createElement('button');
                btn.className = 'select-btn';
                btn.type = 'button';
                btn.innerHTML = '<i class="fas fa-check"></i> Seleccionar';
                btn.addEventListener('click', () => selectProduct(index));
                tdAction.appendChild(btn);

                tr.appendChild(tdCode);
                tr.appendChild(tdDesc);
                tr.appendChild(tdPoints);
                tr.appendChild(tdList);
                tr.appendChild(tdDiscount);
                tr.appendChild(tdSuggested);
                tr.appendChild(tdAction);

                productsTableBody.appendChild(tr);
            });
        }

        // ========================================
        // üî¢ ACTUALIZAR RESUMEN
        // ========================================
        function updateSummaryCounts(filteredCount = null) {
            if (summaryCountEl) summaryCountEl.textContent = products.length;
            if (summaryResultsEl) summaryResultsEl.textContent = filteredCount === null ? '‚Äî' : filteredCount;
        }

        // ========================================
        // ‚è∞ ACTUALIZAR HORA
        // ========================================
        function updateHeaderTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('es-CO', { hour: '2-digit', minute: '2-digit' });
            if (headerTimeEl) headerTimeEl.textContent = timeStr;
        }

        // ========================================
        // üéß EVENT LISTENERS
        // ========================================
        function setupEventListeners() {
            // B√∫squeda con debounce
            searchInput.addEventListener('input', debounce(handleSearch, 300));
            searchInput.addEventListener('keydown', handleSearchKeydown);
            searchInput.addEventListener('focus', () => {
                if (searchInput.value.trim()) handleSearch();
            });

            // Botones de b√∫squeda
            clearSearchBtn.addEventListener('click', clearSearch);
            searchBtn.addEventListener('click', handleSearch);

            // Calculadora
            productSelect.addEventListener('change', handleProductSelection);
            quantityInput.addEventListener('input', validateQuantity);
            calculateBtn.addEventListener('click', calculatePrices);
            resetBtn.addEventListener('click', resetCalculator);

            // Cerrar resultados al hacer clic fuera
            document.addEventListener('click', (e) => {
                if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                    hideSearchResults();
                }
            });
        }

        // ========================================
        // üîç B√öSQUEDA DE PRODUCTOS
        // ========================================
        function handleSearch() {
            const query = searchInput.value.trim().toLowerCase();
            
            if (!query) {
                hideSearchResults();
                updateSummaryCounts(null);
                return;
            }

            const filtered = products.filter(p =>
                p.code.toLowerCase().includes(query) ||
                p.description.toLowerCase().includes(query)
            );

            displaySearchResults(filtered);
            updateSummaryCounts(filtered.length);
        }

        function displaySearchResults(filtered) {
            searchResults.innerHTML = '';

            if (filtered.length === 0) {
                const noResults = document.createElement('div');
                noResults.className = 'search-result-item no-results';
                noResults.innerHTML = '<i class="fas fa-search-minus"></i> No se encontraron resultados';
                searchResults.appendChild(noResults);
            } else {
                filtered.forEach((product, index) => {
                    const item = document.createElement('div');
                    item.className = 'search-result-item';
                    item.setAttribute('role', 'option');
                    item.setAttribute('tabindex', '0');
                    
                    const codeEl = document.createElement('div');
                    codeEl.className = 'result-code';
                    codeEl.textContent = product.code;

                    const descEl = document.createElement('div');
                    descEl.className = 'result-desc';
                    descEl.textContent = product.description;

                    const priceEl = document.createElement('div');
                    priceEl.className = 'result-price';
                    priceEl.textContent = `Tu costo: ${formatCurrency(product.discount35)}`;

                    item.appendChild(codeEl);
                    item.appendChild(descEl);
                    item.appendChild(priceEl);

                    const productIndex = products.indexOf(product);
                    item.addEventListener('click', () => {
                        selectProduct(productIndex);
                        hideSearchResults();
                    });

                    searchResults.appendChild(item);
                });
            }

            searchResults.style.display = 'block';
            searchResults.setAttribute('aria-expanded', 'true');
        }

        function hideSearchResults() {
            searchResults.style.display = 'none';
            searchResults.setAttribute('aria-expanded', 'false');
            searchFocusIndex = -1;
        }

        function handleSearchKeydown(e) {
            const items = Array.from(searchResults.querySelectorAll('.search-result-item:not(.no-results)'));
            if (!items.length) return;

            if (e.key === 'ArrowDown') {
                e.preventDefault();
                searchFocusIndex = Math.min(searchFocusIndex + 1, items.length - 1);
                updateSearchFocus(items);
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                searchFocusIndex = Math.max(searchFocusIndex - 1, 0);
                updateSearchFocus(items);
            } else if (e.key === 'Enter') {
                e.preventDefault();
                if (searchFocusIndex >= 0 && items[searchFocusIndex]) {
                    items[searchFocusIndex].click();
                }
            } else if (e.key === 'Escape') {
                hideSearchResults();
            }
        }

        function updateSearchFocus(items) {
            items.forEach(i => i.classList.remove('focus'));
            const current = items[searchFocusIndex];
            if (current) {
                current.classList.add('focus');
                current.scrollIntoView({ block: 'nearest' });
            }
        }

        function clearSearch() {
            searchInput.value = '';
            hideSearchResults();
            searchInput.focus();
            updateSummaryCounts(null);
        }

        // ========================================
        // ‚úÖ SELECCIONAR PRODUCTO
        // ========================================
        function selectProduct(index) {
            if (typeof index !== 'number' || index < 0 || index >= products.length) return;
            
            selectedProduct = products[index];
            productSelect.value = index.toString();

            console.log(`‚úÖ Producto seleccionado: ${selectedProduct.description.slice(0, 60)}`);

            quantityInput.focus();
            if (quantityInput.value && Number(quantityInput.value) > 0) {
                calculatePrices();
            }
        }

        function handleProductSelection() {
            const idx = productSelect.value;
            if (idx === '') {
                selectedProduct = null;
                resultsDiv.style.display = 'none';
            } else {
                selectProduct(parseInt(idx, 10));
            }
        }

        // ========================================
        // ‚úîÔ∏è VALIDAR CANTIDAD
        // ========================================
        function validateQuantity() {
            let v = parseInt(quantityInput.value, 10);
            if (isNaN(v) || v < 1) v = 1;
            if (v > 1000000) v = 1000000;
            quantityInput.value = v;
        }

        // ========================================
        // üßÆ CALCULAR PRECIOS
        // ========================================
        function calculatePrices() {
            if (!selectedProduct) {
                alert('‚ö†Ô∏è Por favor selecciona un producto primero');
                return;
            }

            const qty = parseInt(quantityInput.value, 10) || 1;
            const totalCost = selectedProduct.discount35 * qty;
            const totalSuggestedPrice = selectedProduct.suggestedPrice * qty;
            const totalProfit = totalSuggestedPrice - totalCost;
            const profitMargin = totalCost > 0 ? (totalProfit / totalCost) * 100 : NaN;

            // Actualizar UI
            document.getElementById('costResult').textContent = formatCurrency(totalCost);
            document.getElementById('priceResult').textContent = formatCurrency(totalSuggestedPrice);
            document.getElementById('profitResult').textContent = formatCurrency(totalProfit);
            
            const marginEl = document.getElementById('marginResult');
            marginEl.textContent = formatPercentage(profitMargin);
            marginEl.className = 'result-value';
            
            if (isNaN(profitMargin)) {
                marginEl.classList.add('text-muted');
            } else if (profitMargin >= 50) {
                marginEl.classList.add('text-success');
            } else if (profitMargin >= 30) {
                marginEl.classList.add('text-warning');
            } else {
                marginEl.classList.add('text-danger');
            }

            resultsDiv.style.display = 'block';
            console.log(`üìä C√°lculo: ${selectedProduct.description} x${qty} -> Ganancia ${formatCurrency(totalProfit)} (${formatPercentage(profitMargin)})`);
        }

        // ========================================
        // üîÑ REINICIAR CALCULADORA
        // ========================================
        function resetCalculator() {
            selectedProduct = null;
            productSelect.value = '';
            quantityInput.value = '1';
            resultsDiv.style.display = 'none';
            searchInput.value = '';
            hideSearchResults();
            updateSummaryCounts(null);
            console.log('üîÑ Calculadora reiniciada');
        }

        // ========================================
        // üé¨ INICIAR APLICACI√ìN
        // ========================================
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
